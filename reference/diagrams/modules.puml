@startuml modules

skinparam backgroundColor #FEFEFE
skinparam defaultFontName "Segoe UI"
skinparam defaultFontSize 12
skinparam shadowing true
skinparam roundcorner 10

skinparam package {
    BackgroundColor #FFFFFF
    BorderColor #455A64
    FontColor #263238
    BorderThickness 2
}

skinparam component {
    BorderColor #37474F
    FontColor #263238
    BorderThickness 1.5
}

title <size:20><b>Module Dependency Graph</b></size>\n<size:14><color:#546E7A>23 source modules â€” include/ headers and src/ implementations</color></size>

package "Foundation" #E8F5E9 {
    component "<b>dsp_utils.h</b>\n<size:10>Complex, windows, helpers\n13 functions</size>" as UTILS #C8E6C9
    component "<b>signal_gen.h</b>\n<size:10>Impulse, cosine, chirp, noise\n12 functions</size>" as SIGGEN #C8E6C9
    component "<b>convolution.h</b>\n<size:10>Convolve, correlate, energy\n7 functions</size>" as CONV #C8E6C9
}

package "Transforms" #E3F2FD {
    component "<b>fft.h</b>\n<size:10>Radix-2 FFT/IFFT, real FFT\n5 functions</size>" as FFT #BBDEFB
    component "<b>advanced_fft.h</b>\n<size:10>Goertzel, sliding DFT, DTMF\n7 functions</size>" as AFFT #BBDEFB
}

package "Spectral Analysis" #F3E5F5 {
    component "<b>spectrum.h</b>\n<size:10>Periodogram, Welch PSD\n6 functions</size>" as SPEC #E1BEE7
    component "<b>spectral_est.h</b>\n<size:10>MUSIC, Capon, eigendecomp\n5 functions</size>" as SEST #E1BEE7
    component "<b>cepstrum.h</b>\n<size:10>Cepstrum, MFCCs, DCT-II\n8 functions</size>" as CEPS #E1BEE7
}

package "Filters" #FFF3E0 {
    component "<b>filter.h</b>\n<size:10>FIR filter, moving avg, lowpass\n3 functions</size>" as FILT #FFECB3
    component "<b>iir.h</b>\n<size:10>Biquad, SOS, Butterworth, Chebyshev\n17 functions</size>" as IIR #FFECB3
    component "<b>remez.h</b>\n<size:10>Parks-McClellan equiripple FIR\n3 functions</size>" as REMEZ #FFECB3
    component "<b>adaptive.h</b>\n<size:10>LMS, NLMS, RLS\n12 functions</size>" as ADAPT #FFECB3
}

package "Multirate & Streaming" #E0F7FA {
    component "<b>multirate.h</b>\n<size:10>Decimate, interpolate, polyphase\n4 functions</size>" as MULTI #B2EBF2
    component "<b>streaming.h</b>\n<size:10>Overlap-Add / Overlap-Save\n6 functions</size>" as STREAM #B2EBF2
}

package "Analysis" #FCE4EC {
    component "<b>correlation.h</b>\n<size:10>FFT-based xcorr, autocorr\n5 functions</size>" as CORR #F8BBD0
    component "<b>hilbert.h</b>\n<size:10>Analytic signal, envelope\n5 functions</size>" as HILB #F8BBD0
    component "<b>lpc.h</b>\n<size:10>Levinson-Durbin, AR model\n6 functions</size>" as LPC #F8BBD0
    component "<b>averaging.h</b>\n<size:10>Coherent, EMA, median filter\n5 functions</size>" as AVG #F8BBD0
}

package "Numeric" #FFF9C4 {
    component "<b>fixed_point.h</b>\n<size:10>Q15/Q31, SQNR, FIR-Q15\n16 functions</size>" as FIXPT #FFF176
    component "<b>dsp2d.h</b>\n<size:10>2D conv, Sobel, FFT2D\n10 functions</size>" as DSP2D #FFF176
}

package "Real-Time & Optimisation" #FFCCBC {
    component "<b>realtime.h</b>\n<size:10>Ring buffer, frame proc, latency\n17 functions</size>" as RT #FFAB91
    component "<b>optimization.h</b>\n<size:10>Radix-4 FFT, twiddle tables\n10 functions</size>" as OPT #FFAB91
}

package "Visualisation" #ECEFF1 {
    component "<b>gnuplot.h</b>\n<size:10>Pipe-based PNG plot output\n8 functions</size>" as GP #CFD8DC
}

' === Dependencies on dsp_utils.h ===
SIGGEN .[#2E7D32,dashed].> UTILS : Complex
FFT .[#1565C0,dashed].> UTILS : Complex
AFFT .[#1565C0,dashed].> UTILS : Complex
IIR .[#E65100,dashed].> UTILS : Complex
HILB .[#C62828,dashed].> UTILS : Complex
SPEC .[#6A1B9A,dashed].> UTILS : window_fn
STREAM .[#00838F,dashed].> UTILS : Complex
RT .[#BF360C,dashed].> UTILS : Complex
OPT .[#BF360C,dashed].> UTILS : Complex

note bottom of UTILS #FFFDE7
  <b>Root dependency</b>: 9 of 23 modules
  depend on dsp_utils.h for Complex
  type and window functions
end note

legend right
  |= Color |= Group |= Modules |
  | <#C8E6C9> | Foundation | 3 |
  | <#BBDEFB> | Transforms | 2 |
  | <#E1BEE7> | Spectral | 3 |
  | <#FFECB3> | Filters | 4 |
  | <#B2EBF2> | Multirate | 2 |
  | <#F8BBD0> | Analysis | 4 |
  | <#FFF176> | Numeric | 2 |
  | <#FFAB91> | Real-Time | 2 |
  | <#CFD8DC> | Visualisation | 1 |
  |  | <b>Total</b> | <b>23</b> |
endlegend

@enduml
