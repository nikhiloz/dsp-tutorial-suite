@startuml api_reference

skinparam backgroundColor #FEFEFE
skinparam defaultFontName "Segoe UI"
skinparam defaultFontSize 11
skinparam shadowing true
skinparam roundcorner 10

skinparam class {
    BorderThickness 1.5
    FontColor #263238
    AttributeFontSize 10
}

title <size:20><b>Public API Reference</b></size>\n<size:14><color:#546E7A>Complete C API â€” 23 headers, ~150 public functions</color></size>

package "Foundation (Phase 1)" #E8F5E9 {
    class "<b>dsp_utils.h</b>" as UTILS #C8E6C9 {
        <b>Types</b>: Complex, window_fn
        --
        complex_add / sub / mul / mag / phase
        complex_from_polar
        hann_window / hamming_window / blackman_window
        apply_window
        next_power_of_2 / db_from_magnitude / rms
    }

    class "<b>signal_gen.h</b>" as SIGGEN #C8E6C9 {
        gen_impulse / gen_step / gen_exponential
        gen_cosine / gen_sine / gen_complex_exp
        gen_chirp / gen_multi_tone
        gen_white_noise / gen_gaussian_noise
        signal_add / signal_scale
    }

    class "<b>convolution.h</b>" as CONV #C8E6C9 {
        convolve / convolve_causal
        cross_correlate / auto_correlate
        is_bibo_stable / signal_energy / signal_power
    }
}

package "Transforms (Phase 2)" #E3F2FD {
    class "<b>fft.h</b>" as FFT #BBDEFB {
        fft / ifft / fft_real
        fft_magnitude / fft_phase
    }

    class "<b>advanced_fft.h</b>" as AFFT #BBDEFB {
        <b>Types</b>: SlidingDFT
        --
        goertzel / goertzel_magnitude_sq / goertzel_freq
        dtmf_detect
        sliding_dft_init / update / free
    }
}

package "Spectral Analysis (Phase 2-4)" #F3E5F5 {
    class "<b>spectrum.h</b>" as SPEC #E1BEE7 {
        periodogram / periodogram_windowed
        welch_psd / cross_psd
        psd_to_db / psd_freq_axis
    }

    class "<b>spectral_est.h</b>" as SEST #E1BEE7 {
        correlation_matrix / eigen_symmetric
        music_spectrum / music_frequencies
        capon_spectrum
    }

    class "<b>cepstrum.h</b>" as CEPS #E1BEE7 {
        cepstrum_real / cepstrum_complex
        cepstrum_lifter
        hz_to_mel / mel_to_hz
        mel_filterbank / compute_mfcc / dct_ii
    }
}

package "Filters (Phase 3)" #FFF3E0 {
    class "<b>filter.h</b>" as FILT #FFECB3 {
        fir_filter / fir_moving_average / fir_lowpass
    }

    class "<b>iir.h</b>" as IIR #FFECB3 {
        <b>Types</b>: Biquad, BiquadDF1State,
        BiquadDF2TState, SOSCascade
        --
        iir_filter / iir_impulse_response
        biquad_df1_init / biquad_df2t_init
        biquad_process_df1 / biquad_process_df2t
        biquad_process_block
        sos_init / sos_process_sample / sos_process_block
        butterworth_lowpass / butterworth_highpass
        chebyshev1_lowpass
        freq_response / biquad_freq_response
        sos_freq_response / group_delay_at
    }

    class "<b>remez.h</b>" as REMEZ #FFECB3 {
        <b>Types</b>: RemezBand
        --
        remez_fir / remez_lowpass / remez_bandpass
    }

    class "<b>adaptive.h</b>" as ADAPT #FFECB3 {
        <b>Types</b>: LmsState, NlmsState, RlsState
        --
        lms_init / lms_update / lms_free / lms_filter
        nlms_init / nlms_update / nlms_free / nlms_filter
        rls_init / rls_update / rls_free / rls_filter
    }
}

package "Multirate & Streaming (Phase 3)" #E0F7FA {
    class "<b>multirate.h</b>" as MULTI #B2EBF2 {
        decimate / interpolate / resample
        polyphase_decimate
    }

    class "<b>streaming.h</b>" as STREAM #B2EBF2 {
        <b>Types</b>: OlaState, OlsState
        --
        ola_init / ola_process / ola_free
        ols_init / ols_process / ols_free
    }
}

package "Analysis (Phase 4)" #FCE4EC {
    class "<b>correlation.h</b>" as CORR #F8BBD0 {
        xcorr / xcorr_normalized
        autocorr / autocorr_normalized
        xcorr_peak_lag
    }

    class "<b>hilbert.h</b>" as HILB #F8BBD0 {
        hilbert_design / analytic_signal
        analytic_signal_fft
        envelope / inst_frequency
    }

    class "<b>lpc.h</b>" as LPC #F8BBD0 {
        lpc_autocorrelation / levinson_durbin
        lpc_coefficients / lpc_residual
        lpc_synthesise / lpc_spectrum
    }

    class "<b>averaging.h</b>" as AVG #F8BBD0 {
        coherent_average / ema_filter
        moving_average / median_filter
        compute_snr_improvement
    }
}

package "Numeric (Phase 5-6)" #FFF9C4 {
    class "<b>fixed_point.h</b>" as FIXPT #FFF176 {
        <b>Types</b>: q15_t, q31_t
        --
        double_to_q15 / q15_to_double
        q15_add / sub / mul / neg / abs
        double_to_q31 / q31_to_double
        q31_add / sub / mul
        double_array_to_q15 / q15_array_to_double
        fir_filter_q15 / compute_sqnr
    }

    class "<b>dsp2d.h</b>" as DSP2D #FFF176 {
        conv2d / kernel_gaussian / kernel_sobel
        kernel_log / kernel_sharpen
        sobel_magnitude
        fft2d / ifft2d / filter2d_freq / lpf2d_ideal
    }
}

package "Real-Time & Optimisation (Phase 7)" #FFCCBC {
    class "<b>realtime.h</b>" as RT #FFAB91 {
        <b>Types</b>: RingBuffer, FrameProcessor,
        LatencyStats
        --
        ring_buffer_create / destroy / write / read
        ring_buffer_available / space / peek / skip / reset
        frame_processor_create / destroy / feed
        frame_processor_peak_bin / peak_freq
        timer_usec / latency_init / latency_record / latency_avg
    }

    class "<b>optimization.h</b>" as OPT #FFAB91 {
        <b>Types</b>: BenchResult, TwiddleTable
        --
        bench_fft_radix2 / bench_fft_radix4 / bench_print
        fft_radix4 / ifft_radix4
        twiddle_create / twiddle_destroy / fft_with_twiddles
        aligned_alloc_dsp / aligned_free_dsp
    }
}

package "Visualisation" #ECEFF1 {
    class "<b>gnuplot.h</b>" as GP #CFD8DC {
        <b>Types</b>: GpSeries
        --
        gp_init / gp_open / gp_close
        gp_send_y / gp_send_xy
        gp_plot_1 / gp_plot_multi / gp_plot_spectrum
    }
}

' Key relationships
FFT ..> UTILS : Complex
AFFT ..> UTILS : Complex
SPEC ..> UTILS : window_fn
IIR ..> UTILS : Complex
HILB ..> UTILS : Complex
SIGGEN ..> UTILS : Complex
STREAM ..> UTILS : Complex
RT ..> UTILS : Complex
OPT ..> UTILS : Complex

@enduml
